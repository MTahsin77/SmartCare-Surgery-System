{% extends 'base.html' %}

{% block title %}{% if gp %}Edit GP{% else %}Add New GP{% endif %}{% endblock %}

{% block content %}
<h1>{% if gp %}Edit GP{% else %}Add New GP{% endif %}</h1>
<form method="post" id="gp-form">
    {% csrf_token %}
    {{ form.as_p }}
    <button type="submit" class="btn btn-primary">Save GP Details</button>
</form>
<a href="{% url 'gp_list' %}" class="btn btn-secondary mt-3">Back to GP List</a>
{% endblock %}

{% block extra_scripts %}
<script src="https://maps.googleapis.com/maps/api/js?key={{ GOOGLE_MAPS_API_KEY }}&libraries=places"></script>
<script>
    function initAutocomplete() {
        var input = document.getElementById('address-input');
        var autocomplete = new google.maps.places.Autocomplete(input);

        autocomplete.addListener('place_changed', function() {
            var place = autocomplete.getPlace();
            if (!place.geometry) {
                console.log("No details available for input: '" + place.name + "'");
                return;
            }

            document.getElementById('id_latitude').value = place.geometry.location.lat();
            document.getElementById('id_longitude').value = place.geometry.location.lng();
        });
    }

    google.maps.event.addDomListener(window, 'load', initAutocomplete);
</script>
{% endblock %}